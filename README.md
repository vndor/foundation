# Foundation

![PHP Support](https://img.shields.io/badge/php-5.6-brightgreen.svg)
![PHP Support](https://img.shields.io/badge/php-7-brightgreen.svg)
![Dependencies](https://img.shields.io/badge/dependencies-none-brightgreen.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Travis](https://travis-ci.org/GonistLelatel/aphp_foundation.svg?branch=master)

![PackageGenerator](images/package-gen.jpg)

## Introduction

`Foundation` is a foundation classes for PHP.

## Installation

```
composer require aphp/foundation ~2.0.0
```
## Classes

* ANullObject
	* used as mock object
	* allowed to call __any methods__ and __any properties__
		* see [example-null.php](example/example-null.php)
* AException
	* used to organize store the exceptions in single file
	* used 1 class for exceptions
	* used 1 file for exceptions
	* text of exception is autogenerated
		* see [example-exception.php](example/example-exception.php)
		* see [example-exception2.php](example/example-exception2.php)
* Container
	* used for __container pattern__
	* container is a copy of __pimple-container__ implementation
	* use __container trait__ to make any class like container
	* [Container documentation](DOC-CONTAINER.md)
* TraitSingleton
	* used for __singleton pattern__
* FunctionsAutoloader
	* used to require functions in packages without the composer autoloader registration
	* used in packages, not recommended in project code
* Validator
	* used to throw exceptions for invalid values

<details><summary><b>&#x1F535; APHP Packages list</b></summary>
<p>

![Class map](https://gonistlelatel.github.io/resources/foundation/map.jpg)

</p></details>

### Composer package generator

![PackageGenerator](images/package-gen.jpg)

`Composer package generator` used to generate new packages as PSR-4 with `aphp/foundation` integration

* see [projectGen2](https://github.com/GonistLelatel/projectGen2)
* shell example:
	```
	> mkdir aphp_pakagename
	> cd aphp_pakagename
	> projectGen --p composerPackage --t . --vendor aphp --name pakagename --namespace PakageNameSpace
	```

<details><summary><b>&#x1F535; Functions Autoloader</b></summary>
<p>

### Functions Autoloader

```php
<?php
namespace aphp\Foundation;

class FunctionsAutoloader {
	static function autoload() { }
}
```

Problem: PSR-4 cant load functions

https://stackoverflow.com/questions/24171078/composer-psr-how-to-autoload-functions

Solution:
```php
// Functions.php
<?php
namespace vendor/package;

class Functions extends \aphp\Foundation\FunctionsAutoloader { }

function foo() {

}

function bar() {

}
```
Call `Functions::autoload()` after `use`
```php
// SomeClass.php
<?php
namespace vendor/package;
Functions::autoload();

class SomeClass {
	function f1() {
		$a = foo(); // functions is visible
		$b = bar();
	}
}
```
</p></details>

<details><summary><b>&#x1F535; Validator</b></summary>
<p>

### Validator

Class
```php
define('INVALID', '__invalid___');

class Validator
{
	use TraitSingleton;

	public function validate(
		$validation,
		$value = null,
		$exceptionText = null
	);
}
```
`$validation`
* string
* Closure
* [ string ]
* [ Closure ]

`$value` - value for \Closure OR for function

`$exceptionText` - custom exception text

`validate()` return the result of __function__ OR __Closure__ execution, if it is VALID

Example usage with global function "validate":

```php
use function aphp\Foundation\validate;

$file = validate('is_file', 'invalid/path'); // throws
$file = validate('is_file', __FILE__); // ok

$file = validate(function(){ return false; }); // throws
$file = validate(function(){ return ''; }); // throws
$file = validate(function(){ return null; }); // throws
$file = validate(function(){ return INVALID; }); // throws
$file = validate(function(){ return true; }); // ok
$file = validate(function(){ return 0; }); // ok

// ! operator support
$text = validate(['!is_bool','!is_int'], 'text'); // ok
$text = validate(['!is_bool','is_int'], 'text'); // throws
$text = validate(['!is_string'], 'text'); // throws

$file = validate(
	function($value){ return is_string($value); },
	'hello world'
); // ok
```
Multiple rules
```php
$file = validate(['file_exists'], new StdClass); // error
$file = validate(['is_string','file_exists'], new StdClass); // no error, throws
```
Inheritance
```php
use function aphp\Foundation\validate;

class MyValidator extends Validator {
	protected function isValid($value) {
		return $value == 'hello world';
	}
}
Validator::$instance = new MyValidator;
$myvalidator = new MyValidator;

$file = validate(function(){ return 'hello world'; }); // ok
$file = validate(function(){ return 'bye world'; }); // throws
$file = $myvalidator->validate(function(){ return 'hello world'; }); // ok
$file = $myvalidator->validate(function(){ return 'bye world'; }); // throws
```

</p></details>

<details><summary><b>&#x1F535; Useful links</b></summary>
<p>

* Composer package generator
	* [projectGen2](https://github.com/GonistLelatel/projectGen2)
* Cmd windows
	* [WindowsPathEditor](https://rix0rrr.github.io/WindowsPathEditor/)
	* [conemu](https://conemu.github.io/)
* PHP downloads
	* [windows.php.net](https://windows.php.net/)
	* [xampp](https://www.apachefriends.org/ru/index.html)
	* [openserver](https://open-server.soft112.com/)
* PHP installations
	* [install-php-on-windows](https://www.utilizewindows.com/install-php-on-windows/)
	* [phpunit 5](https://phpunit.de/getting-started/phpunit-5.html)
	* [phpunit in bat](https://stackoverflow.com/questions/24861233/phpunit-setup-in-batch-file)
	* [composer in bat](http://leedavis81.github.io/global-installation-of-composer-on-windows/)
* Git client
	* [git](https://gitforwindows.org/)
	* [smartgit](https://www.syntevo.com/smartgit/)

</p>
</details>

## Example running
* install __composer, php__ if not installed
* run __composer install__ at package dir
* run __cd example__
* run __php %example file%.php__

## More features
For more features:
* read source code and examples
* practice with `Foundation` in real code
